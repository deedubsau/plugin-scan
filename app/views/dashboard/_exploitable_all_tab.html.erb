<div class="tab-pane active" id="exploitable-all-tab">
  <p>Below is a list of all exploitable hosts detected by <%= product_name %>.</p>
  <table class="table table-bordered table-condensed table-striped" id="exploitable-table">
    <thead>
      <tr>
        <th>IP</th>
        <th>OS</th>
        <th>Browser</th>
        <th>Status</th>  
        <th>Time</th>
      </tr>
    </thead>
    <tbody>
    <% @exploitable_hosts.each do |host| %>
      <tr>
        <td>
          <%= host[:ip] %>
        </td>
        <td>
          <img src="/assets/icon_<%= host[:os] %>_16x16.png" border="0">
          <%= @software_names[host[:os]] %>
        </td>
        <td>
          <img src="/assets/icon_<%= host[:br] %>_16x16.png" border="0">
          <%= @software_names[host[:br]]  %>
        </td>
        <td>
           <p>
           <% text = [] %>
             <% unless host[:br_v].nil? %>
               <img src="/assets/icon_<%= host[:br] %>_32x32.png" border="0">
               <% text.push(@software_names[host[:br]]) %>
             <% end %>
             <% unless host[:ao_dvr].nil? %>
               <img src="/assets/icon_devalvr_32x32.png" border="0">
               <% text.push(@software_names["dvr"]) %>
             <% end %>
             <% unless host[:ao_flash].nil? %>
               <img src="/assets/icon_flash_32x32.png" border="0">
               <% text.push(@software_names["flash"]) %>
             <% end %>
             <% unless host[:ao_java].nil? %>
               <img src="/assets/icon_java_32x32.png" border="0">
               <% text.push(@software_names["java"]) %>
             <% end %>
             <% unless host[:ao_qt].nil? %>
               <img src="/assets/icon_quicktime_32x32.png" border="0">
               <% text.push(@software_names["qt"]) %>
             <% end %>
             <% unless host[:ao_reader].nil? %>
               <img src="/assets/icon_reader_32x32.png" border="0">
               <% text.push(@software_names["reader"]) %>
             <% end %>
             <% unless host[:ao_shockwave].nil? %>
               <% text.push(@software_names["shock"]) %>
               <img src="/assets/icon_shockwave_32x32.png" border="0">
             <% end %>
             <% unless host[:ao_silver].nil? %>
               <% text.push(@software_names["silver"]) %>
               <img src="/assets/icon_silverlight_32x32.png" border="0">
             <% end %>
             <% unless host[:ao_tp].nil? %>
               <% text.push(@software_names["rp"]) %>
               <img src="/assets/icon_realplayer_32x32.png" border="0">
             <% end %>
             <% unless host[:ao_vlc].nil? %>
               <% text.push(@software_names["vlc"]) %>
               <img src="/assets/icon_vlc_32x32.png" border="0">
             <% end %>
             <% unless host[:ao_wmp].nil? %>
               <% text.push(@software_names["wmp"]) %>
               <img src="/assets/icon_wmp_32x32.png" border="0">
             <% end %>
           </p>
           <p>
             <% case text.length
               when 1 %>
                 <%= text[0] %> is exploitable.
               <% when 2 %>
                 <%= text.join(" and ") %> are exploitable.
               <% when 0 %>
                 Nothing is exploitable
               <% else %>
                 <% text[-1] = " and " + text[-1] %>
                 <%= text.join(", ") %> are exploitable.
             <% end %>
           </p>
          </td>
          <td>
            <%= host[:created_at] %>
          </td>    
      </tr>
    <% end %>
    </tbody>
  </table>
 </div>
 <script>
 $(document).ready(function(){
   $('#exploitable-table').dataTable( {
     "sDom": "<'row'<'span6'l><'span6'f>r>t<'row'<'span6'i><'span6'p>>",
      "sPaginationType": "bootstrap"
    } );
 });
 </script>
