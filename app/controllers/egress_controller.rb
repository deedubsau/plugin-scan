class EgressController < ApplicationController

  def index
    unless params[:ports].nil?
      @ports = (26..1024).to_a
      #@ports = params[:ports].split(",")
      @port_details = []
      @ports.each do |port|
        @port_details.push(port_description(port))
      end
    end
  end

private

  def port_description(port)
    well_known_ports = {
    "1" => ["TCP Port Service Multiplexer (TCPMUX)", "Official"],
    "2" => ["CompressNET[2] Management Utility[3]", "Official"],
    "3" => ["CompressNET[2] Compression Process[4]", "Official"],
    "4" => ["Unassigned", "Official"],
    "5" => ["Remote Job Entry", "Official"],
    "7" => ["Echo Protocol", "Official"],
    "8" => ["Unassigned", "Official"],
    "9" => ["Discard Protocol", "Official"],
    "10" => ["Unassigned", "Official"],
    "11" => ["Active Users (systat service)[5][6]", "Official"],
    "12" => ["Unassigned", "Official"],
    "13" => ["Daytime Protocol (RFC 867)", "Official"],
    "14" => ["Unassigned", "Official"],
    "15" => ["Previously netstat service[5]", "Unofficial"],
    "16" => ["Unassigned", "Official"],
    "17" => ["Quote of the Day", "Official"],
    "18" => ["Message Send Protocol", "Official"],
    "19" => ["Character Generator Protocol (CHARGEN)", "Official"],
    "20" => ["FTP data transfer", "Official"],
    "21" => ["FTP control (command)", "Official"],
    "22" => ["Secure Shell (SSH) used for secure logins, file transfers (scp, sftp) and port forwarding", "Official"],
    "23" => ["Telnet protocol unencrypted text communications", "Official"],
    "24" => ["Priv-mail : any private mail system.", "Official"],
    "25" => ["Simple Mail Transfer Protocol (SMTP) used for e-mail routing between mail servers", "Official"],
    "26" => ["Unassigned", "Official"],
    "27" => ["NSW User System FE", "Official"],
    "29" => ["MSG ICP", "Official"],
    "33" => ["Display Support Protocol", "Official"],
    "35" => ["Any private printer server protocol", "Official"],
    "37" => ["TIME protocol", "Official"],
    "39" => ["Resource Location Protocol[7] (RLP) used for determining the location of higher level services from hosts on a network", "Official"],
    "40" => ["Unassigned", "Official"],
    "42" => ["Windows Internet Name Service", "Unofficial"],
    "42" => ["ARPA Host Name Server Protocol", "Official"],
    "43" => ["WHOIS protocol", "Official"],
    "47" => ["NI FTP[7]", "Official"],
    "49" => ["TACACS Login Host protocol", "Official"],
    "50" => ["Remote Mail Checking Protocol[8]", "Official"],
    "51" => ["IMP Logical Address Maintenance", "Official"],
    "52" => ["XNS (Xerox Network Systems) Time Protocol", "Official"],
    "53" => ["Domain Name System (DNS)", "Official"],
    "54" => ["XNS (Xerox Network Systems) Clearinghouse", "Official"],
    "55" => ["ISI Graphics Language (ISI-GL)", "Official"],
    "56" => ["XNS (Xerox Network Systems) Authentication", "Official"],
    "56" => ["Route Access Protocol (RAP)[9]", "Unofficial"],
    "57" => ["Mail Transfer Protocol (RFC 780)", "Official"],
    "58" => ["XNS (Xerox Network Systems) Mail", "Official"],
    "67" => ["Bootstrap Protocol (BOOTP) Server; also used by Dynamic Host Configuration Protocol (DHCP)", "Official"],
    "68" => ["Bootstrap Protocol (BOOTP) Client; also used by Dynamic Host Configuration Protocol (DHCP)", "Official"],
    "69" => ["Trivial File Transfer Protocol (TFTP)", "Official"],
    "70" => ["Gopher protocol", "Official"],
    "71" => ["NETRJS protocol", "Official"],
    "72" => ["NETRJS protocol", "Official"],
    "73" => ["NETRJS protocol", "Official"],
    "74" => ["NETRJS protocol", "Official"],
    "79" => ["Finger protocol", "Official"],
    "80" => ["Hypertext Transfer Protocol (HTTP)", "Official"],
    "81" => ["Torpark Onion routing", "Unofficial"],
    "82" => ["Torpark Control", "Unofficial"],
    "88" => ["Kerberos authentication system", "Official"],
    "90" => ["PointCast (dotcom)", "Unofficial"],
    "90" => ["dnsix (DoD Network Security for Information Exchange) Securit Attribute Token Map", "Official"],
    "99" => ["WIP Message protocol", "Unofficial"],
    "101" => ["NIC host name", "Official"],
    "102" => ["ISO-TSAP (Transport Service Access Point) Class 0 protocol[11]", "Official"],
    "104" => ["ACR/NEMA Digital Imaging and Communications in Medicine", "Official"],
    "105" => ["CCSO Nameserver Protocol (Qi/Ph)", "Official"],
    "107" => ["Remote TELNET Service[12] protocol", "Official"],
    "108" => ["SNA Gateway Access Server [1]", "Official"],
    "109" => ["Post Office Protocol v2 (POP2)", "Official"],
    "110" => ["Post Office Protocol v3 (POP3)", "Official"],
    "111" => ["ONC RPC (SunRPC)", "Official"],
    "113" => ["ident Authentication Service/Identification Protocol,[13] used by IRC servers to identify users", "Official"],
    "113" => ["Authentication Service[13] (auth)", "Official"],
    "115" => ["Simple File Transfer Protocol (SFTP)", "Official"],
    "117" => ["UUCP Path Service", "Official"],
    "118" => ["SQL (Structured Query Language) Services", "Official"],
    "119" => ["Network News Transfer Protocol (NNTP) retrieval of newsgroup messages", "Official"],
    "123" => ["Network Time Protocol (NTP) used for time synchronization", "Official"],
    "126" => ["Formerly Unisys Unitary Login, renamed by Unisys to NXEdit. Used by Unisys Programmer's Workbench for Clearpath MCP, an IDE for Unisys MCP software development", "Official"],
    "135" => ["Microsoft EPMAP (End Point Mapper), also known as DCE/RPC Locator service,[14] used to remotely manage services including DHCP server, DNS server and WINS. Also used by DCOM", "Unofficial"],
    "135" => ["DCE endpoint resolution", "Official"],
    "137" => ["NetBIOS NetBIOS Name Service", "Official"],
    "138" => ["NetBIOS NetBIOS Datagram Service", "Official"],
    "139" => ["NetBIOS NetBIOS Session Service", "Official"],
    "143" => ["Internet Message Access Protocol (IMAP) management of email messages", "Official"],
    "152" => ["Background File Transfer Program (BFTP)[15]", "Official"],
    "153" => ["SGMP, Simple Gateway Monitoring Protocol", "Official"],
    "156" => ["SQL Service", "Official"],
    "158" => ["DMSP, Distributed Mail Service Protocol[16]", "Unofficial"],
    "161" => ["Simple Network Management Protocol (SNMP)", "Official"],
    "162" => ["Simple Network Management Protocol Trap (SNMPTRAP)[17]", "Official"],
    "170" => ["Print-srv, Network PostScript", "Official"],
    "175" => ["VMNET (IBM z/VM, z/OS & z/VSE - Network Job Entry(NJE))", "Official"],
    "177" => ["X Display Manager Control Protocol (XDMCP)", "Official"],
    "179" => ["BGP (Border Gateway Protocol)", "Official"],
    "194" => ["Internet Relay Chat (IRC)", "Official"],
    "199" => ["SMUX, SNMP Unix Multiplexer", "Official"],
    "201" => ["AppleTalk Routing Maintenance", "Official"],
    "209" => ["The Quick Mail Transfer Protocol", "Official"],
    "210" => ["ANSI Z39.50", "Official"],
    "213" => ["Internetwork Packet Exchange (IPX)", "Official"],
    "218" => ["Message posting protocol (MPP)", "Official"],
    "220" => ["Internet Message Access Protocol (IMAP), version 3", "Official"],
    "259" => ["ESRO, Efficient Short Remote Operations", "Official"],
    "264" => ["BGMP, Border Gateway Multicast Protocol", "Official"],
    "280" => ["http-mgmt", "Official"],
    "308" => ["Novastor Online Backup", "Official"],
    "311" => ["Mac OS X Server Admin (officially AppleShare IP Web administration)", "Official"],
    "318" => ["PKIX TSP, Time Stamp Protocol", "Official"],
    "319" => ["Precision time protocol event messages", "Official"],
    "320" => ["Precision time protocol general messages", "Official"],
    "350" => ["MATIP-Type A, Mapping of Airline Traffic over Internet Protocol", "Official"],
    "351" => ["MATIP-Type B, Mapping of Airline Traffic over Internet Protocol", "Official"],
    "366" => ["ODMR, On-Demand Mail Relay", "Official"],
    "369" => ["Rpc2portmap", "Official"],
    "370" => ["securecast1 Outgoing packets to NAI's servers [18][dead link]", "Unofficial"],
    "370" => ["codaauth2 Coda authentication server", "Official"],
    "370" => ["codaauth2 Coda authentication server", "Official"],
    "371" => ["ClearCase albd", "Official"],
    "383" => ["HP data alarm manager", "Official"],
    "384" => ["A Remote Network Server System", "Official"],
    "387" => ["AURP, AppleTalk Update-based Routing Protocol[19]", "Official"],
    "389" => ["Lightweight Directory Access Protocol (LDAP)", "Official"],
    "401" => ["UPS Uninterruptible Power Supply", "Official"],
    "427" => ["Service Location Protocol (SLP)", "Official"],
    "443" => ["HTTPS (Hypertext Transfer Protocol over SSL/TLS)", "Official"],
    "444" => ["SNPP, Simple Network Paging Protocol (RFC 1568)", "Official"],
    "445" => ["Microsoft-DS SMB file sharing", "Official"],
    "445" => ["Microsoft-DS Active Directory, Windows shares", "Official"],
    "464" => ["Kerberos Change/Set password", "Official"],
    "465" => ["URL Rendesvous Directory for SSM (Cisco protocol)", "Official"],
    "475" => ["tcpnethaspsrv (Aladdin Knowledge Systems Hasp services, TCP/IP version)", "Official"],
    "497" => ["Dantz Retrospect", "Official"],
    "500" => ["Internet Security Association and Key Management Protocol (ISAKMP)", "Official"],
    "502" => ["Modbus, Protocol", "Unofficial"],
    "504" => ["Citadel multiservice protocol for dedicated clients for the Citadel groupware system", "Official"],
    "512" => ["Rexec, Remote Process Execution", "Official"],
    "512" => ["comsat, together with biff", "Official"],
    "513" => ["Who[20]", "Official"],
    "513" => ["rlogin", "Official"],
    "514" => ["Syslog used for system logging", "Official"],
    "514" => ["Shell used to execute non-interactive commands on a remote system (Remote Shell, rsh, remsh)", "Official"],
    "515" => ["Line Printer Daemon print service", "Official"],
    "517" => ["Talk", "Official"],
    "518" => ["NTalk", "Official"],
    "520" => ["Routing Information Protocol (RIP)", "Official"],
    "520" => ["efs, extended file name server", "Official"],
    "524" => ["NetWare Core Protocol (NCP) is used for a variety things such as access to primary NetWare server resources, Time Synchronization, etc.", "Official"],
    "525" => ["Timed, Timeserver", "Official"],
    "530" => ["RPC", "Official"],
    "531" => ["AOL Instant Messenger", "Unofficial"],
    "532" => ["netnews", "Official"],
    "533" => ["netwall, For Emergency Broadcasts", "Official"],
    "540" => ["UUCP (Unix-to-Unix Copy Protocol)", "Official"],
    "542" => ["commerce (Commerce Applications)", "Official"],
    "543" => ["klogin, Kerberos login", "Official"],
    "544" => ["kshell, Kerberos Remote shell", "Official"],
    "545" => ["OSIsoft PI (VMS), OSISoft PI Server Client Access", "Unofficial"],
    "546" => ["DHCPv6 client", "Official"],
    "547" => ["DHCPv6 server", "Official"],
    "548" => ["Apple Filing Protocol (AFP) over TCP", "Official"],
    "550" => ["new-rwho, new-who[20]", "Official"],
    "554" => ["Real Time Streaming Protocol (RTSP)", "Official"],
    "556" => ["Remotefs, RFS, rfs_server", "Official"],
    "560" => ["rmonitor, Remote Monitor", "Official"],
    "561" => ["monitor", "Official"],
    "563" => ["NNTP protocol over TLS/SSL (NNTPS)", "Official"],
    "587" => ["e-mail message submission[21] (SMTP)", "Official"],
    "591" => ["FileMaker 6.0 (and later) Web Sharing (HTTP Alternate, also see port 80)", "Official"],
    "593" => ["HTTP RPC Ep Map, Remote procedure call over Hypertext Transfer Protocol, often used by Distributed Component Object Model services and Microsoft Exchange Server", "Official"],
    "604" => ["TUNNEL profile,[22] a protocol for BEEP peers to form an application layer tunnel", "Official"],
    "623" => ["ASF Remote Management and Control Protocol (ASF-RMCP)", "Official"],
    "631" => ["Internet Printing Protocol (IPP)", "Official"],
    "631" => ["Common Unix Printing System (CUPS)", "Unofficial"],
    "635" => ["RLZ DBase", "Official"],
    "636" => ["Lightweight Directory Access Protocol over TLS/SSL (LDAPS)", "Official"],
    "639" => ["MSDP, Multicast Source Discovery Protocol", "Official"],
    "641" => ["SupportSoft Nexus Remote Command (control/listening): A proxy gateway connecting remote control traffic", "Official"],
    "646" => ["LDP, Label Distribution Protocol, a routing protocol used in MPLS networks", "Official"],
    "647" => ["DHCP Failover protocol[23]", "Official"],
    "648" => ["RRP (Registry Registrar Protocol)[24]", "Official"],
    "651" => ["IEEE-MMS", "Official"],
    "653" => ["SupportSoft Nexus Remote Command (data): A proxy gateway connecting remote control traffic", "Official"],
    "654" => ["Media Management System (MMS) Media Management Protocol (MMP)[25]", "Official"],
    "657" => ["IBM RMC (Remote monitoring and Control) protocol, used by System p5 AIX Integrated Virtualization Manager (IVM)[26] and Hardware Management Console to connect managed logical partitions (LPAR) to enable dynamic partition reconfiguration", "Official"],
    "660" => ["Mac OS X Server administration", "Official"],
    "666" => ["Doom, first online first-person shooter", "Official"],
    "666" => ["airserv-ng, aircrack-ng's server for remote-controlling wireless devices", "Unofficial"],
    "674" => ["ACAP (Application Configuration Access Protocol)", "Official"],
    "688" => ["REALM-RUSD (ApplianceWare Server Appliance Management Protocol)", "Official"],
    "691" => ["MS Exchange Routing", "Official"],
    "694" => ["Linux-HA High availability Heartbeat", "Official"],
    "695" => ["IEEE-MMS-SSL (IEEE Media Management System over SSL)[27]", "Official"],
    "698" => ["OLSR (Optimized Link State Routing)", "Official"],
    "700" => ["EPP (Extensible Provisioning Protocol), a protocol for communication between domain name registries and registrars (RFC 5734)", "Official"],
    "701" => ["LMP (Link Management Protocol (Internet)),[28] a protocol that runs between a pair of nodes and is used to manage traffic engineering (TE) links", "Official"],
    "702" => ["IRIS[29][30] (Internet Registry Information Service) over BEEP (Blocks Extensible Exchange Protocol)[31] (RFC 3983)", "Official"],
    "706" => ["Secure Internet Live Conferencing (SILC)", "Official"],
    "711" => ["Cisco Tag Distribution Protocol[32][33][34] being replaced by the MPLS Label Distribution Protocol[35]", "Official"],
    "712" => ["Topology Broadcast based on Reverse-Path Forwarding routing protocol (TBRPF) (RFC 3684)", "Official"],
    "749" => ["Kerberos (protocol) administration", "Official"],
    "750" => ["kerberos-iv, Kerberos version IV", "Official"],
    "751" => ["kerberos_master, Kerberos authentication", "Unofficial"],
    "752" => ["passwd_server, Kerberos Password (kpasswd) server", "Unofficial"],
    "753" => ["userreg_server, Kerberos userreg server", "Unofficial"],
    "753" => ["Reverse Routing Header (rrh)[36]", "Official"],
    "753" => ["Reverse Routing Header (rrh)", "Official"],
    "754" => ["tell send", "Official"],
    "754" => ["tell send", "Official"],
    "754" => ["krb5_prop, Kerberos v5 slave propagation", "Unofficial"],
    "760" => ["krbupdate [kreg], Kerberos registration", "Unofficial"],
    "782" => ["Conserver serial-console management server", "Unofficial"],
    "783" => ["SpamAssassin spamd daemon", "Unofficial"],
    "808" => ["Microsoft Net.TCP Port Sharing Service", "Official"],
    "829" => ["Certificate Management Protocol[37]", "Unofficial"],
    "843" => ["Adobe Flash[38]", "Official"],
    "847" => ["DHCP Failover protocol", "Official"],
    "848" => ["Group Domain Of Interpretation (GDOI) protocol", "Official"],
    "860" => ["iSCSI (RFC 3720)", "Official"],
    "861" => ["OWAMP control (RFC 4656)", "Official"],
    "862" => ["TWAMP control (RFC 5357)", "Official"],
    "873" => ["rsync file synchronization protocol", "Official"],
    "888" => ["cddbp, CD DataBase (CDDB) protocol (CDDBP)", "Unofficial"],
    "897" => ["Brocade SMI-S RPC", "Unofficial"],
    "898" => ["Brocade SMI-S RPC SSL", "Unofficial"],
    "901" => ["VMware Virtual Infrastructure Client (UDP from server being managed to management console)", "Unofficial"],
    "901" => ["VMware Virtual Infrastructure Client (UDP from server being managed to management console)", "Unofficial"],
    "901" => ["Samba Web Administration Tool (SWAT)", "Unofficial"],
    "902" => ["VMware Server Console (UDP from server being managed to management console)", "Unofficial"],
    "902" => ["VMware Server Console (TCP from management console to server being Managed)", "Unofficial"],
    "902" => ["ideafarm-door", "Official"],
    "902" => ["ideafarm-door", "Official"],
    "903" => ["VMware Remote Console [39]", "Unofficial"],
    "904" => ["VMware Server Alternate (if 902 is in use, i.e. SUSE linux)", "Unofficial"],
    "911" => ["Network Console on Acid (NCA) local tty redirection over OpenSSH", "Unofficial"],
    "944" => ["Network File System (protocol) Service", "Unofficial"],
    "953" => ["Domain Name System (DNS) RNDC Service", "Unofficial"],
    "973" => ["Network File System (protocol) over IPv6 Service", "Unofficial"],
    "981" => ["SofaWare Technologies Remote HTTPS management for firewall devices running embedded Check Point FireWall-1 software", "Unofficial"],
    "987" => ["Microsoft Corporation Microsoft Windows SBS SharePoint", "Unofficial"],
    "989" => ["FTPS Protocol (data): FTP over TLS/SSL", "Official"],
    "990" => ["FTPS Protocol (control): FTP over TLS/SSL", "Official"],
    "991" => ["NAS (Netnews Administration System)[40]", "Official"],
    "992" => ["TELNET protocol over TLS/SSL", "Official"],
    "993" => ["Internet Message Access Protocol over SSL (IMAPS)", "Official"],
    "995" => ["Post Office Protocol 3 over TLS/SSL (POP3S)", "Official"],
    "999" => ["ScimoreDB Database System", "Unofficial"],
    "1000" => ["Opsware agent (aka cogbot)", "Unofficial"],
    }
    unless well_known_ports[port.to_s].nil?
      return [ port, well_known_ports[port.to_s][0], well_known_ports[port.to_s][1] ]
    else
      return [ port, "Unassigned", "Unassigned" ]
    end
  end


end
