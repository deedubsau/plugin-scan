require 'plugin_scan/vulnerability_checker'

module PluginScan
  describe VulnerabilityChecker do
    describe ".is_vulnerable?" do
      let(:issues) do 
        double(number_of_outdated_versions: 0,
               number_of_vulnerabilities: 0,
               number_of_exploits: 0)
      end

      context "with outdated versions" do
        before { issues.stub(:number_of_outdated_versions) { 1 } }

        it "returns true" do
          expect(VulnerabilityChecker.is_vulnerable?(issues)).to be_true
        end
      end

      context "with vulnerabilities" do
        before { issues.stub(:number_of_vulnerabilities) { 1 } }

        it "returns true" do
          expect(VulnerabilityChecker.is_vulnerable?(issues)).to be_true
        end
      end

      context "with exploits" do
        before { issues.stub(:number_of_exploits) { 1 } }

        it "returns true" do
          expect(VulnerabilityChecker.is_vulnerable?(issues)).to be_true
        end
      end

      context "with no issues" do
        it "returns false" do
          expect(VulnerabilityChecker.is_vulnerable?(issues)).to be_false
        end
      end
    end
  end
end
