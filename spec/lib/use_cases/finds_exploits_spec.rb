require 'use_cases/finds_exploits'

module UseCases
  describe FindsExploits do
    let(:software) { 'test-name' }
    let(:version)  { 'test-version' }
    let(:db) { double }

    before { stub_const('VulnDb', Class.new) }
    subject { FindsExploits.new(software, version) }

    describe "#find_exploits" do
      it "looks for exploits using the VulnDb" do
        VulnDb.stub(:for).with(software, version) { db }
        exploit = double
        db.stub(:exploits) { [exploit] }
        expect(subject.find_exploits).to eq([exploit])
      end
    end
  end
end
